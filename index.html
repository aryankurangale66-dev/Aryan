<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Cloth Shop Management</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f4f9; margin: 0; padding: 0; }
    .container { width: 80%; margin: auto; padding: 20px; }
    h1 { text-align: center; color: #333; }
    .menu { margin: 20px 0; text-align: center; }
    button { margin: 5px; padding: 10px 20px; font-size: 16px; cursor: pointer; border-radius: 5px; border: none; background: #007bff; color: #fff; }
    button:hover { background: #0056b3; }
    .section { display: none; margin-top: 20px; padding: 15px; background: #fff; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th, td { border: 1px solid #ddd; padding: 10px; text-align: center; }
    th { background: #007bff; color: white; }
    input { padding: 8px; margin: 5px; width: 200px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Cloth Shop Management</h1>

    <div class="menu">
      <button onclick="showSection('addItem')">Add Item</button>
      <button onclick="showSection('inventory')">Show Inventory</button>
      <button onclick="showSection('makeSale')">Make Sale</button>
      <button onclick="showSection('sales')">Show Sales</button>
    </div>

    <!-- Add Item -->
    <div id="addItem" class="section">
      <h2>Add New Item</h2>
      <input type="text" id="itemId" placeholder="Item ID"><br>
      <input type="text" id="itemName" placeholder="Item Name"><br>
      <input type="number" id="itemPrice" placeholder="Price"><br>
      <input type="number" id="itemStock" placeholder="Stock"><br>
      <button onclick="addItem()">Add Item</button>
    </div>

    <!-- Inventory -->
    <div id="inventory" class="section">
      <h2>Inventory</h2>
      <table>
        <thead>
          <tr>
            <th>ID</th><th>Name</th><th>Price</th><th>Stock</th>
          </tr>
        </thead>
        <tbody id="inventoryTable"></tbody>
      </table>
    </div>

    <!-- Make Sale -->
    <div id="makeSale" class="section">
      <h2>Make Sale</h2>
      <input type="text" id="saleCustomer" placeholder="Customer Name"><br>
      <input type="text" id="saleItemId" placeholder="Item ID"><br>
      <input type="number" id="saleQty" placeholder="Quantity"><br>
      <button onclick="makeSale()">Add to Bill</button>
      <div id="billDetails"></div>
    </div>

    <!-- Sales -->
    <div id="sales" class="section">
      <h2>Sales Record</h2>
      <table>
        <thead>
          <tr>
            <th>Customer</th><th>Total</th><th>Date</th>
          </tr>
        </thead>
        <tbody id="salesTable"></tbody>
      </table>
    </div>
  </div>

  <script>
    let inventory = JSON.parse(localStorage.getItem("inventory")) || {};
    let sales = JSON.parse(localStorage.getItem("sales")) || [];

    function saveData() {
      localStorage.setItem("inventory", JSON.stringify(inventory));
      localStorage.setItem("sales", JSON.stringify(sales));
    }

    function showSection(id) {
      document.querySelectorAll('.section').forEach(sec => sec.style.display = "none");
      document.getElementById(id).style.display = "block";
      if (id === "inventory") loadInventory();
      if (id === "sales") loadSales();
    }

    function addItem() {
      let id = document.getElementById("itemId").value;
      let name = document.getElementById("itemName").value;
      let price = parseFloat(document.getElementById("itemPrice").value);
      let stock = parseInt(document.getElementById("itemStock").value);

      if (id && name && !isNaN(price) && !isNaN(stock)) {
        inventory[id] = { name, price, stock };
        saveData();
        alert("Item added!");
        document.getElementById("itemId").value = "";
        document.getElementById("itemName").value = "";
        document.getElementById("itemPrice").value = "";
        document.getElementById("itemStock").value = "";
      } else {
        alert("Please enter valid details!");
      }
    }

    function loadInventory() {
      let table = document.getElementById("inventoryTable");
      table.innerHTML = "";
      for (let id in inventory) {
        let item = inventory[id];
        table.innerHTML += `<tr>
          <td>${id}</td>
          <td>${item.name}</td>
          <td>₹${item.price}</td>
          <td>${item.stock}</td>
        </tr>`;
      }
    }

    let currentBill = [];
    let currentTotal = 0;

    function makeSale() {
      let customer = document.getElementById("saleCustomer").value;
      let itemId = document.getElementById("saleItemId").value;
      let qty = parseInt(document.getElementById("saleQty").value);

      if (itemId in inventory && qty > 0 && qty <= inventory[itemId].stock) {
        let cost = qty * inventory[itemId].price;
        inventory[itemId].stock -= qty;
        currentBill.push({ item: inventory[itemId].name, qty, cost });
        currentTotal += cost;
        displayBill();
        saveData();
      } else {
        alert("Invalid item or insufficient stock!");
      }
    }

    function displayBill() {
      let div = document.getElementById("billDetails");
      div.innerHTML = "<h3>Bill</h3>";
      currentBill.forEach(b => {
        div.innerHTML += `<p>${b.item} x ${b.qty} = ₹${b.cost}</p>`;
      });
      div.innerHTML += `<h3>Total = ₹${currentTotal}</h3>`;
      div.innerHTML += `<button onclick="finalizeSale()">Finalize Sale</button>`;
    }

    function finalizeSale() {
      let customer = document.getElementById("saleCustomer").value;
      if (!customer) {
        alert("Enter customer name!");
        return;
      }
      sales.push({ customer, bill: currentBill, total: currentTotal, date: new Date().toLocaleString() });
      currentBill = [];
      currentTotal = 0;
      document.getElementById("billDetails").innerHTML = "";
      document.getElementById("saleCustomer").value = "";
      document.getElementById("saleItemId").value = "";
      document.getElementById("saleQty").value = "";
      saveData();
      alert("Sale recorded successfully!");
    }

    function loadSales() {
      let table = document.getElementById("salesTable");
      table.innerHTML = "";
      sales.forEach(s => {
        table.innerHTML += `<tr>
          <td>${s.customer}</td>
          <td>₹${s.total}</td>
          <td>${s.date}</td>
        </tr>`;
      });
    }
  </script>
</body>
</html>
